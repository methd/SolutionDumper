<Window x:Class="SolutionDumper.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:SolutionDumper.ViewModels"
        Title="Solution Dumper" Height="750" Width="1200">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <DockPanel Margin="10" Grid.Row="0" LastChildFill="False">
            <Button Content="Open .sln"
                    Width="120"
                    Margin="0,0,10,0"
                    Command="{Binding OpenSlnCommand}"/>
            <TextBlock VerticalAlignment="Center"
                       Text="{Binding SlnPath}"
                       Margin="0,0,15,0"/>
        </DockPanel>

        <Grid Grid.Row="1" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="3*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0"
                    BorderBrush="#DDD"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="10">
                <DockPanel LastChildFill="True">

                    <StackPanel DockPanel.Dock="Top" Margin="0,0,0,10">
                        <TextBlock Text="Filter tree:"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,4"/>

                        <TextBox Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}"
                                 Padding="6,3"
                                 FontSize="13"
                                 VerticalContentAlignment="Center"/>

                        <TextBlock Text="Matches file / folder / project name or path"
                                   Opacity="0.6"
                                   FontSize="11"
                                   Margin="0,4,0,0"/>
                    </StackPanel>

                    <TreeView ItemsSource="{Binding Roots}">
                        <TreeView.ItemContainerStyle>
                            <Style TargetType="{x:Type TreeViewItem}">
                                <Setter Property="IsExpanded"
                                        Value="{Binding IsExpanded, Mode=TwoWay}" />
                                <Setter Property="Visibility"
                                        Value="{Binding IsVisible, Converter={StaticResource BoolToVis}}"/>
                            </Style>
                        </TreeView.ItemContainerStyle>

                        <TreeView.Resources>
                            <HierarchicalDataTemplate DataType="{x:Type vm:TreeNodeViewModel}"
                                                      ItemsSource="{Binding Children}">
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsThreeState="{Binding HasChildren}"
                                              IsChecked="{Binding IsChecked, Mode=TwoWay}"
                                              VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding DisplayName}"
                                               Margin="6,0,0,0"/>
                                </StackPanel>
                            </HierarchicalDataTemplate>
                        </TreeView.Resources>
                    </TreeView>
                </DockPanel>
            </Border>

            <Border Grid.Column="1"
                    BorderBrush="#DDD"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="10"
                    Margin="10,0,0,0">
                <DockPanel>
                    <StackPanel DockPanel.Dock="Top"
                                Orientation="Horizontal"
                                Margin="0,0,0,10">
                        <TextBlock Text="Selected files:"
                                   FontWeight="SemiBold"
                                   Margin="0,0,10,0"/>
                        <TextBlock Text="{Binding SelectedFileCount}"/>
                        <TextBlock Text="  |  Total size:"
                                   Margin="15,0,5,0"/>
                        <TextBlock Text="{Binding SelectedTotalSizeText}"/>
                    </StackPanel>

                    <ListBox ItemsSource="{Binding SelectedFiles}"
                             VirtualizingPanel.IsVirtualizing="True"
                             VirtualizingPanel.VirtualizationMode="Recycling"/>
                </DockPanel>
            </Border>
        </Grid>

        <DockPanel Margin="10" Grid.Row="2" LastChildFill="False">
            <Button Content="Export…"
                    Width="120"
                    Command="{Binding ExportCommand}"/>
        </DockPanel>
    </Grid>
</Window>